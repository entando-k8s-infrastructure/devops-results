
Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-credential-initializer-hqn6t[0m
Unable to retrieve container logs for docker://c259e8b44346f204ad271092a123fc19798b86194220744fd57328b063aaaa14

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-working-dir-initializer-xxnkp[0m
{"level":"warn","ts":1602062143.4266446,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: open /var/run/ko/HEAD: no such file or directory"}
{"level":"info","ts":1602062143.4374554,"logger":"fallback-logger","caller":"bash/main.go:64","msg":"Successfully e**cuted command \"sh -c mkdir -p /workspace/source\"; output "}

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-place-tools[0m

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-git-source-entando-k8s-entando-k8s-composi-zgt5n[0m
{"level":"warn","ts":1602062267.6168764,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/0.8.0-**-support-backwards-incompats\" is not a valid GitHub commit ID"}
{"level":"info","ts":1602062268.9323606,"logger":"fallback-logger","caller":"git/git.go:103","msg":"Successfully cloned https://github.com/entando-k8s/entando-k8s-composite-app-controller.git @ master in path /workspace/source"}

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-git-merge[0m
Using SHAs from PULL_REFS=master:0ca48a3840a2efe2d2f11f764480a9af04e81d29,10:698caea433a9e82b97913387e9104e64b446c3ec
DEBUG: ran git fetch --unshallow origin 698caea433a9e82b97913387e9104e64b446c3ec: 0ca48a3840a2efe2d2f11f764480a9af04e81d29: in 
DEBUG: ran git checkout master in 
DEBUG: ran git reset --hard 0ca48a3840a2efe2d2f11f764480a9af04e81d29 in 
DEBUG: ran clean --force -d . in 
DEBUG: ran git merge 698caea433a9e82b97913387e9104e64b446c3ec in 
Merged SHA 698caea433a9e82b97913387e9104e64b446c3ec with commit message 'ENG-1266 fi**d broken pipeline' into base branch master
Merged SHA 099b444049d9bf93dbe3eb1a3e01c322c3e7db0d with commit message 'ENG-1266 increased timeout for test' into base branch master
Merged SHA f1a7fe1b2f2658d32a3a30d0a274cebd7aaf00f9 with commit message 'ENG-1266 bumped to latest version of all projects' into base branch master

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-build-set-version[0m
Unable to retrieve container logs for docker://cdbe7149c3b9f1175c6fa8212536007c983b03792e9ca6460869e042db114757

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-build-fix-git-for-sonar[0m
Unable to retrieve container logs for docker://ea1a24c3e7e11668be0404156d4e3a1d0c0926cb45f9df14db4bf6ff05bbe779

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-build-mvn-verify-pr[0m
failed to open log file "/var/log/pods/a5ee2928-087d-11eb-9e44-765ed317cb17/step-build-mvn-verify-pr/0.log": open /var/log/pods/a5ee2928-087d-11eb-9e44-765ed317cb17/step-build-mvn-verify-pr/0.log: no such file or directory

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-build-container-build[0m
Generating tags...
 - entando/entando-k8s-composite-app-controller -> docker.io/entando/entando-k8s-composite-app-controller:0.0.0-SNAPSHOT-PR-10-7
Checking cache...
 - entando/entando-k8s-composite-app-controller: Not found. Building
Building [entando/entando-k8s-composite-app-controller]...
Sending build context to Docker daemon  535.6kBSending build context to Docker daemon   5.47MBSending build context to Docker daemon     11MBSending build context to Docker daemon  17.61MBSending build context to Docker daemon  24.85MBSending build context to Docker daemon  27.61MBSending build context to Docker daemon   28.7MBSending build context to Docker daemon  34.23MBSending build context to Docker daemon  38.05MBSending build context to Docker daemon  39.09MB
Step 1/6 : FROM fabric8/java-alpine-openjdk8-jre
 ---> 6383f0513235
Step 2/6 : ENV JAVA_OPTIONS "-Dquarkus.http.host=0.0.0.0 -Djava.util.logging.manager=org.jboss.logmanager.LogManager"
 ---> Using cache
 ---> 781f0699f0f0
Step 3/6 : ENV AB_ENABLED jmx_exporter
 ---> Using cache
 ---> 3d03a75b86f8
Step 4/6 : COPY target/lib/* /deployments/lib/
 ---> Using cache
 ---> 150b888b6a6f
Step 5/6 : COPY target/*-runner.jar /deployments/app.jar
 ---> 9ce40f1f7e3e
Step 6/6 : ENTRYPOINT /deployments/run-java.sh
 ---> Running in 4e3b51bef58b
 ---> 47fda35b5e98
Successfully built 47fda35b5e98
The push refers to a repository [docker.io/entando/entando-k8s-composite-app-controller]
a015577b169b: Preparing
7a16f30ffc9b: Preparing
a37d6baa8a5e: Preparing
4246c252be29: Preparing
bbc6d89e45a1: Preparing
6a8968c88953: Preparing
c11f0dd7f64f: Preparing
081a861c7ecd: Preparing
df5b415aa3df: Preparing
77cae8ab23bf: Preparing
6a8968c88953: Waiting
df5b415aa3df: Waiting
081a861c7ecd: Waiting
c11f0dd7f64f: Waiting
77cae8ab23bf: Waiting
7a16f30ffc9b: Layer already exists
a37d6baa8a5e: Layer already exists
4246c252be29: Layer already exists
bbc6d89e45a1: Layer already exists
6a8968c88953: Layer already exists
081a861c7ecd: Layer already exists
df5b415aa3df: Layer already exists
c11f0dd7f64f: Layer already exists
77cae8ab23bf: Layer already exists
a015577b169b: Pushed
0.0.0-SNAPSHOT-PR-10-7: digest: sha256:dfef881e554542cb63e6f0b7bdeee99be22404c09913a39dd9a5291d58baac87 size: 2410
There is a new version (1.15.0) of Skaffold available. Download it at https://storage.googleapis.com/skaffold/releases/latest/skaffold-linux-amd64


Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-postbuild-post-build[0m
Unable to retrieve container logs for docker://8eb850678fe0277a88da3cf58a6f89531a52e21b124fbe141147eceb9835456e

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-promote-make-preview[0m
sed -i -e "s/version:.*/version: 0.0.0-SNAPSHOT-PR-10-7/" Chart.yaml
sed -i -e "s/version:.*/version: 0.0.0-SNAPSHOT-PR-10-7/" ../*/Chart.yaml
sed -i -e "s|repository:.*|repository: docker.io\/entando\/entando-k8s-composite-app-controller|" values.yaml
sed -i -e "s/tag:.*/tag: 0.0.0-SNAPSHOT-PR-10-7/" values.yaml
sed -i -e "s/ENTANDO_DOCKER_REGISTRY_OVERRIDE:.*/ENTANDO_DOCKER_REGISTRY_OVERRIDE: docker.io/" values.yaml
echo "  version: 0.0.0-SNAPSHOT-PR-10-7" >> requirements.yaml
** step helm build
WARNING: No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080
Adding missing Helm repo: storage.googleapis.com https://storage.googleapis.com/chartmuseum.jenkins-x.io
Successfully added Helm repository storage.googleapis.com.
Adding missing Helm repo: jenkins-x-chartmuseum http://jenkins-x-chartmuseum:8080
Successfully added Helm repository jenkins-x-chartmuseum.
WARNING: No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-promote-jx-preview[0m
Unable to retrieve container logs for docker://4604c162ab746e48b0019b7a45d86a6489806118f247ea7cbdd99476427d5229

Showing logs for build [32mentando-k8s-entando-k8s-composi-hnkb8-7[0m stage [32mfrom-build-pack[0m and container [32mstep-promote-run-post-deployment-tests[0m
Picked up _JAVA_OPTIONS: -XX:+UnlockExperimentalVMOptions -Dsun.zip.disableMemoryMapping=true -XX:+UseParallelGC -XX:MinHeapFreeRatio=5 -XX:MaxHeapFreeRatio=10 -XX:GCTimeRatio=4 -XX:AdaptiveSizePolicyWeight=90 -Xms1000m -Xmx12000m
[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for org.entando:entando-k8s-composite-app-controller:jar:0.0.0-SNAPSHOT-PR-10-7
[WARNING] 'dependencyManagement.dependencies.dependency.(groupId:artifactId:type:classifier)' must be unique: org.yaml:snakeyaml:jar -> version 1.27 vs ${snakeyaml.version} @ org.entando:entando-quarkus-parent:6.2.3, /home/jenkins/.mvnrepository/org/entando/entando-quarkus-parent/6.2.3/entando-quarkus-parent-6.2.3.pom, line 283, column 25
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO] 
[INFO] ----------< org.entando:entando-k8s-composite-app-controller >----------
[INFO] Building Entando K8S Composite App Controller 0.0.0-SNAPSHOT-PR-10-7
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ entando-k8s-composite-app-controller ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ entando-k8s-composite-app-controller ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ entando-k8s-composite-app-controller ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 6 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ entando-k8s-composite-app-controller ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:3.0.0-M1:test (default-test) @ entando-k8s-composite-app-controller ---
[INFO] Tests are skipped.
[INFO] 
[INFO] --- maven-jar-plugin:3.2.0:jar (default-jar) @ entando-k8s-composite-app-controller ---
[INFO] 
[INFO] --- maven-jar-plugin:3.2.0:test-jar (build-test-jar) @ entando-k8s-composite-app-controller ---
[INFO] 
[INFO] --- maven-failsafe-plugin:3.0.0-M4:integration-test (run-tests) @ entando-k8s-composite-app-controller ---
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.entando.kubernetes.compositeapp.controller.interprocesstests.CompositeAppControllerIntegratedTest
Oct 07, 2020 9:24:44 AM org.entando.kubernetes.controller.integrationtest.support.DeletionWaiter lambda$deleteSingleItem$2
WARNING: Deleting pods  entando-k8s-composite-app-controller-carcpr10/my-app-carcpr10-deployer-1zxdthsuer
!!!!!!!On EntandoCompositeApp add!!!!!!!!!
Oct 07, 2020 9:24:48 AM org.entando.kubernetes.controller.integrationtest.support.DeletionWaiter lambda$deleteSingleItem$2
WARNING: Deleting pods  entando-k8s-composite-app-controller-carcpr10/my-app-carcpr10-deployer-ctbh32ti33
Oct 07, 2020 9:24:48 AM org.entando.kubernetes.controller.integrationtest.support.DeletionWaiter lambda$deleteSingleItem$2
WARNING: Deleting pods  entando-k8s-composite-app-controller-carcpr10/my-app-carcpr10-deployer-mjyvmdewuu
Oct 07, 2020 9:24:48 AM org.entando.kubernetes.controller.integrationtest.support.DeletionWaiter lambda$deleteSingleItem$2
WARNING: Deleting pods  entando-k8s-composite-app-controller-carcpr10/my-app-carcpr10-deployer-uqlcjscoeq
!!!!!!!On EntandoCompositeApp add!!!!!!!!!
[ERROR] Tests run: 2, Failures: 0, Errors: 2, Skipped: 0, Time elapsed: 38.629 s <<< FAILURE! - in org.entando.kubernetes.compositeapp.controller.interprocesstests.CompositeAppControllerIntegratedTest
[ERROR] org.entando.kubernetes.compositeapp.controller.interprocesstests.CompositeAppControllerIntegratedTest.testE**cuteControllerObject  Time elapsed: 4.969 s  <<< ERROR!
io.fabric8.kubernetes.client.KubernetesClientException: Failure e**cuting: POST at: https://172.30.0.1/apis/entando.org/v1/namespaces/entando-k8s-composite-app-controller-carcpr10/entandocompositeapps. Message: entandocompositeapps.entando.org "my-app-carcpr10" already exists. Received status: Status(apiVersion=v1, code=409, details=StatusDetails(causes=[], group=entando.org, kind=entandocompositeapps, name=my-app-carcpr10, retryAfterSeconds=null, uid=null, additionalProperties={}), kind=Status, message=entandocompositeapps.entando.org "my-app-carcpr10" already exists, metadata=ListMeta(_continue=null, remainingItemCount=null, resourceVersion=null, selfLink=null, additionalProperties={}), reason=AlreadyExists, status=Failure, additionalProperties={}).
	at org.entando.kubernetes.compositeapp.controller.interprocesstests.CompositeAppControllerIntegratedTest.performCreate(CompositeAppControllerIntegratedTest.java:73)

[ERROR] org.entando.kubernetes.compositeapp.controller.interprocesstests.CompositeAppControllerIntegratedTest.testE**cuteControllerPod  Time elapsed: 33.601 s  <<< ERROR!
org.awaitility.core.ConditionTimeoutException: Condition with lambda expression in org.entando.kubernetes.compositeapp.controller.AbstractCompositeAppControllerTest that uses io.fabric8.kubernetes.client.dsl.FilterWatchListDeletable was not fulfilled within 30 seconds.

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Errors: 
[ERROR]   CompositeAppControllerIntegratedTest>AbstractCompositeAppControllerTest.testE**cuteControllerObject:219->performCreate:73 Â» KubernetesClient
[ERROR]   CompositeAppControllerIntegratedTest>AbstractCompositeAppControllerTest.testE**cuteControllerPod:117 Â» ConditionTimeout
[INFO] 
[ERROR] Tests run: 2, Failures: 0, Errors: 2, Skipped: 0
[INFO] 
[INFO] 
[INFO] --- maven-surefire-report-plugin:3.0.0-M4:failsafe-report-only (integration-tests) @ entando-k8s-composite-app-controller ---
[WARNING] Unable to locate Test Source XRef to link to - DISABLED
[INFO] 
[INFO] --- maven-surefire-report-plugin:3.0.0-M4:report-only (unit-tests) @ entando-k8s-composite-app-controller ---
[WARNING] Unable to locate Test Source XRef to link to - DISABLED
[INFO] 
[INFO] --- maven-failsafe-plugin:3.0.0-M4:verify (run-tests) @ entando-k8s-composite-app-controller ---
[ERROR] There are test failures.

Please refer to /workspace/source/target/failsafe-reports for the individual test results.
Please refer to dump files (if any exist) [date].dump, [date]-***Run[N].dump and [date].dumpstream.
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  47.738 s
[INFO] Finished at: 2020-10-07T09:25:21Z
[INFO] ------------------------------------------------------------------------
shallow cloning https://github.com/entando-k8s/devops-results.git branch gh-pages
ran git init in /tmp/jenkins-x-collect275867035
ran git add remote origin https://github.com/entando-k8s/devops-results.git in /tmp/jenkins-x-collect275867035
ran git fetch origin --depth=1 gh-pages in dir /tmp/jenkins-x-collect275867035
Publishing https://raw.githubusercontent.com/entando-k8s/devops-results/gh-pages/entando-k8s-composite-app-controller/PR-10/failsafe-report.html
error: failed to collect patterns target/site/failsafe-report* to path entando-k8s-composite-app-controller/PR-10: Have you set up a git credential helper? See https://help.github.com/articles/caching-your-github-password-in-git/
: git output: To https://github.com/entando-k8s/devops-results.git
 ! [remote rejected]   gh-pages -> gh-pages (cannot lock ref 'refs/heads/gh-pages': is at 2b8db39164034f1d1d1092d023d263e37994a237 but expected 6e52392ea45a028e1c6b08d2030d23e1a31c1db4)
error: failed to push some refs to 'https://github.com/entando-k8s/devops-results.git': failed to run 'git push origin gh-pages' command in directory '/tmp/jenkins-x-collect275867035', output: 'To https://github.com/entando-k8s/devops-results.git
 ! [remote rejected]   gh-pages -> gh-pages (cannot lock ref 'refs/heads/gh-pages': is at 2b8db39164034f1d1d1092d023d263e37994a237 but expected 6e52392ea45a028e1c6b08d2030d23e1a31c1db4)
error: failed to push some refs to 'https://github.com/entando-k8s/devops-results.git''
Post-deployment tests failed for entando-k8s-composite-app-controller-PR-10.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100  1901  100  1671  100   230   2613    359 --:--:-- --:--:-- --:--:--  2623
{
  "url": "https://api.github.com/repos/entando-k8s/entando-k8s-composite-app-controller/statuses/698caea433a9e82b97913387e9104e64b446c3ec",
  "avatar_url": "https://avatars2.githubusercontent.com/u/57885396?v=4",
  "id": 10978687241,
  "node_id": "MDEzOlN0YXR1c0NvbnRleHQxMDk3ODY4NzI0MQ==",
  "state": "failure",
  "description": "Post-deployment tests failure!",
  "target_url": "https://entando-k8s.github.io/devops-results/entando-k8s-composite-app-controller/PR-10/failsafe-report.html",
  "context": "Post-deployment tests",
  "created_at": "2020-10-07T09:30:25Z",
  "updated_at": "2020-10-07T09:30:25Z",
  "creator": {
    "login": "entando-**",
    "id": 57885396,
    "node_id": "MDQ6VXNlcjU3ODg1Mzk2",
    "avatar_url": "https://avatars2.githubusercontent.com/u/57885396?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/**********",
    "html_url": "https://github.com/**********",
    "followers_url": "https://api.github.com/users/**********/followers",
    "following_url": "https://api.github.com/users/entando-**/following{/other_user}",
    "gists_url": "https://api.github.com/users/entando-**/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/entando-**/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/**********/subscriptions",
    "organizations_url": "https://api.github.com/users/entando-**/orgs",
    "repos_url": "https://api.github.com/users/entando-**/repos",
    "events_url": "https://api.github.com/users/entando-**/events{/privacy}",
    "received_events_url": "https://api.github.com/users/**********/received_events",
    "type": "User",
    "site_*****": *****
  }
}
[31m
Pipeline failed on stage 'from-build-pack' : container 'step-promote-run-post-deployment-tests'. The execution of the pipeline has stopped.[0m
